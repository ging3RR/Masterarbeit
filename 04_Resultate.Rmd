# Resultate

```{r Setup Results, include=FALSE}
# Topwords
load(file = "E:/R Projects/Daten_MA/Masterarbeit/data/Topwords_Arbeitgeber.rds")
Topwords_Arbeitgeber <- t(Topwords_Arbeitgeber)
Topwords_Arbeitgeber <- as.data.frame(Topwords_Arbeitgeber)
load(file = "E:/R Projects/Daten_MA/Masterarbeit/data/Topwords_Arbeitnehmer.rds")
Topwords_Arbeitnehmer <- t(Topwords_Arbeitnehmer)
Topwords_Arbeitnehmer <- as.data.frame(Topwords_Arbeitnehmer)

# Corpus and DFM
load(file = "E:/R Projects/Daten_MA/Masterarbeit/data/TextArbeitszeit.rda")

Arbeitgeber_csv <- readtext(file = "E:/R Projects/Daten_MA/Masterarbeit/data/Arbeitgeber_Arbeitszeit.csv", encoding = "UTF-8")

#clean corpora
Arbeitgeber_csv$complete_text <- gsub(pattern = "\\-\\s+", 
                                      replacement = "", 
                                      x = Arbeitgeber_csv$complete_text) 
Arbeitgeber_csv$complete_text <- gsub(pattern = "\\;\\s+", 
                                      replacement = "", 
                                      x = Arbeitgeber_csv$complete_text) 
Arbeitgeber_csv$complete_text <- gsub(pattern = "\\..\\s+", 
                                      replacement = " ", 
                                      x = Arbeitgeber_csv$complete_text) 
Arbeitgeber_csv$complete_text <- gsub(pattern = "\\. .\\s+", 
                                      replacement = "", 
                                      x = Arbeitgeber_csv$complete_text) 

#create variable to seperate the corpora
Arbeitgeber_csv$organisation <- "Arbeitgeber"
TextArbeitszeit$organisation <- "Arbeitnehmer"


#create corpus objects
corpus_Arbeitgeber <- corpus(Arbeitgeber_csv, text_field = "complete_text")
corpus_Arbeitnehmer <- corpus(TextArbeitszeit)

corpus_combined <- corpus_Arbeitgeber + corpus_Arbeitnehmer


#make a dfm
corpus_dfm <- tokens(corpus_combined, remove_punct = T, 
                     remove_symbols = T,
                     remove_numbers = T)  %>% 
  tokens_remove(sw) %>% tokens_group(groups = organisation) %>% 
  dfm() %>% dfm_wordstem()
```


## Sentiment Analyse
```{r Setup Sentiment Analyse, include=FALSE}
#Sentiment Analysis
#read in the Dictionaries (http://inhaltsanalyse-mit-r.de/sentiment.html)
load("data/Rauh_SentDictionaryGerman.RData")
sentiment.lexikon.rauh <- dictionary(list(positive = str_trim(sent.dictionary$feature[sent.dictionary$sentiment>0]),
                                          negative = str_trim(sent.dictionary$feature[sent.dictionary$sentiment<0])))



# sentiment pro organisation
meine_dfm_sentiment_org <- corpus_dfm %>% 
  dfm_lookup(dictionary = sentiment.lexikon.rauh)

meine_dfm_sentiment_org_prop <- dfm_weight(meine_dfm_sentiment_org, scheme = "prop")



# plot
sentiment.org <- convert(meine_dfm_sentiment_org_prop, "data.frame") %>% 
  gather(positive, negative, key = "Polarität", value = "Sentiment")

sentiment_plot <- ggplot(sentiment.org, aes(doc_id, Sentiment, colour = Polarität, fill = Polarität)) + 
  geom_bar(stat="identity") + scale_colour_brewer(palette = "Set1") + 
  scale_fill_brewer(palette = "Accent") + 
  ggtitle("Sentiment-Scores in den Zeitungen nach Verband") +
  xlab("") + ylab("Anteil") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r,fig.cap="Sentiment Analyse"}
plot(sentiment_plot)
```


## LDA

### Arbeitnehmer:innen

```{r, results='asis'}
kbl(Topwords_Arbeitnehmer, caption = "Topics Arbeitnehmer", booktabs = T) %>% 
  kable_styling(latex_options = c("scale_down", "hold_position"))
```

### Arbeitgeber:innen

```{r}
kbl(Topwords_Arbeitgeber, caption = "Topics Arbeitgeber", booktabs = T) %>% 
  kable_styling(latex_options = c("scale_down", "hold_position"))
```
